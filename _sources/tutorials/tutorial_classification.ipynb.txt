{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "pFKF6N69kCay"
   },
   "source": [
    "# **Measuring Bias in classification**\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This notebook is a tutorial on auditing bias within a binary classification task. We will use the holisticai library both in the **data exploration** and **measure bias** sections, introducing some of the functions we have created to help study algorithmic bias.\n",
    "\n",
    "The sections are organised as follows :\n",
    "\n",
    ": 1. Load the data : we load the law school dataset as a pandas DataFrame\n",
    ": 2. Data Exploration : some preliminary analysis of the data\n",
    ": 3. Train a Model : we train a simple logistic regression model (sklearn)\n",
    ": 4. Measure Bias : we compute a few bias metrics, and comment on their meaning"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "id": "-nYt5_h77QGN"
   },
   "source": [
    "## **Load the data**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "id": "KgfZWXdy1REj"
   },
   "outputs": [],
   "source": [
    "# Imports\n",
    "import numpy as np\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We host a few example datasets on the holisticai library for quick loading and experimentation. Here we load and use the Law School dataset. The goal of this dataset is the prediction of the binary attribute 'pass_bar' (whether a student passes the law school bar). The protected attributes are race and gender. We pay special attention to race in this case, because preliminary exploration hints there is strong inequality on that sensitive attribute."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>decile1b</th>\n",
       "      <th>decile3</th>\n",
       "      <th>lsat</th>\n",
       "      <th>ugpa</th>\n",
       "      <th>zfygpa</th>\n",
       "      <th>zgpa</th>\n",
       "      <th>fulltime</th>\n",
       "      <th>fam_inc</th>\n",
       "      <th>male</th>\n",
       "      <th>racetxt</th>\n",
       "      <th>tier</th>\n",
       "      <th>pass_bar</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>9.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>46.0</td>\n",
       "      <td>2.9</td>\n",
       "      <td>1.02</td>\n",
       "      <td>0.30</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>6.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>3.3</td>\n",
       "      <td>0.24</td>\n",
       "      <td>-0.45</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>7.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>41.0</td>\n",
       "      <td>3.9</td>\n",
       "      <td>0.54</td>\n",
       "      <td>-0.20</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>7.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>44.0</td>\n",
       "      <td>3.7</td>\n",
       "      <td>0.54</td>\n",
       "      <td>0.84</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>2.9</td>\n",
       "      <td>0.40</td>\n",
       "      <td>0.52</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9995</th>\n",
       "      <td>6.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>3.4</td>\n",
       "      <td>0.14</td>\n",
       "      <td>0.31</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9996</th>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>42.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1.13</td>\n",
       "      <td>1.25</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9997</th>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>2.4</td>\n",
       "      <td>-0.48</td>\n",
       "      <td>-1.66</td>\n",
       "      <td>2.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9998</th>\n",
       "      <td>5.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>31.5</td>\n",
       "      <td>2.9</td>\n",
       "      <td>-0.03</td>\n",
       "      <td>-0.77</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9999</th>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>44.0</td>\n",
       "      <td>3.3</td>\n",
       "      <td>-0.87</td>\n",
       "      <td>-0.99</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10000 rows Ã— 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      decile1b  decile3  lsat  ugpa  zfygpa  zgpa  fulltime  fam_inc  male  \\\n",
       "0          9.0      7.0  46.0   2.9    1.02  0.30       1.0      4.0   1.0   \n",
       "1          6.0      4.0  32.0   3.3    0.24 -0.45       1.0      3.0   0.0   \n",
       "2          7.0      5.0  41.0   3.9    0.54 -0.20       1.0      4.0   0.0   \n",
       "3          7.0      8.0  44.0   3.7    0.54  0.84       1.0      3.0   1.0   \n",
       "4          7.0      7.0  48.0   2.9    0.40  0.52       1.0      5.0   0.0   \n",
       "...        ...      ...   ...   ...     ...   ...       ...      ...   ...   \n",
       "9995       6.0      7.0  36.0   3.4    0.14  0.31       2.0      3.0   1.0   \n",
       "9996       9.0      9.0  42.0   3.5    1.13  1.25       1.0      3.0   0.0   \n",
       "9997       3.0      1.0  30.0   2.4   -0.48 -1.66       2.0      4.0   1.0   \n",
       "9998       5.0      3.0  31.5   2.9   -0.03 -0.77       1.0      4.0   1.0   \n",
       "9999       2.0      2.0  44.0   3.3   -0.87 -0.99       1.0      5.0   0.0   \n",
       "\n",
       "      racetxt  tier  pass_bar  \n",
       "0           1     3         1  \n",
       "1           1     3         1  \n",
       "2           1     4         1  \n",
       "3           1     4         1  \n",
       "4           1     4         1  \n",
       "...       ...   ...       ...  \n",
       "9995        1     4         1  \n",
       "9996        1     3         1  \n",
       "9997        1     3         0  \n",
       "9998        1     3         1  \n",
       "9999        1     3         1  \n",
       "\n",
       "[10000 rows x 12 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Get data\n",
    "from holisticai.datasets import load_lawschool\n",
    "df = load_lawschool()\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## **Data Exploration**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We import some of the holisticai plotters for quick exploration of the data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "from holisticai.bias.plots import group_pie_plot, success_rate_plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# replace the 0,1 with text data for readability\n",
    "\n",
    "p_attr = df['racetxt'].replace({1:'white',0:'non-white'}) # protected attribute\n",
    "y = df['pass_bar']                                        # binary label vector"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "group_pie_plot(p_attr)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The proportion of white people in law school is very high, allready we observe there is a big representation issue."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/giuliofilippi/Documents/GitHub/holisticai/examples/../holisticai/bias/plots/_bias_multiclass_plots.py:46: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  sr_list = sr_list.append(sr_tot)\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYQAAAEmCAYAAABiaec2AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8qNh9FAAAACXBIWXMAAAsTAAALEwEAmpwYAAAeYElEQVR4nO3de1TUdf7H8eeAgBIqijBb2sWjhamgXVTimJorQgaiYcZPV7YyjKyDuiVaaBeNtPKIpqZinjTvbGqIW8gmR61A17TSLCUzSyVBQBEJ4ja/P5ymJZBBZWZWfD3O8Zz5zvf2/vph5jWfz3fm+zWYTCYTIiJy3XNydAEiIvK/QYEgIiKAAkFERMwUCCIiAigQRETETIEgIiKAAkGuExcuXCAxMZHg4GD8/f0ZOHAgb7zxBsXFxZZlxowZwxtvvOGwGs+dO0ffvn3Jzs52WA1yfWvm6AJEbK24uJjIyEg8PDyYNm0at912Gz/++CNvvvkm+/btY9WqVbi5uTm0xrNnzxITE8OZM2ccWodc3xQI0uTNmTMHk8nEihUraNGiBQA333wznTt3ZvDgwWzevJnIyEiH1ff5558THx+Pp6enw2oQAQ0ZSRNXXl5Oamoqf/vb3yxh8LubbrqJlStXEhISUmu9yspKEhMTGThwIN26dSMwMJCEhASqqqoAyM3NJSYmhnvuuYd7772X2NhYCgoKgIvDU8899xx9+vShZ8+ejB07luPHj1+yxh07djB69GjefvvtxjtwkSugQJAm7cSJE5SUlODv71/n/HvuuafOT+bvvvsuKSkpzJ49m23bthEXF8eaNWvIyMgA4NVXX6WiooLk5GRWr17NqVOnmD17NgDz58/n2LFjrFy5ks2bN+Ps7MyLL754yRrj4+OJjo7GyUkvR3EsDRlJk1ZUVARAy5YtL2u9zp07M2vWLHr37g1Ahw4dWL58OdnZ2QQFBXHy5Ek6duxIhw4dcHNzY+7cuZSUlABw8uRJWrRoQfv27WnZsiUzZ87k1KlTjXtgIjagjyTSpLVp0wb4IxgaatCgQTg7O/PWW28xfvx4Bg0aRHZ2NtXV1QDExMSQkZFBnz59iImJYe/evXTu3BmAJ554guzsbO677z4ef/xx0tPTueOOOxr3wERsQIEgTdott9yCp6cnBw8erHP+rFmzWLFiRa3nFy5cyDPPPENVVRWDBw9m6dKl3HnnnZb5Q4YMYefOnUyfPp3mzZuTkJBAdHQ0AL169WLHjh28+eabGI1GFixYwKOPPkpZWZlNjlGksSgQpElzdnYmNDSUVatW1XpD/umnn1i3bh0uLi611lu+fDlTpkxh6tSpDBs2jA4dOpCTk8PvV4ufN28eJ0+eJCIignnz5rFw4UJ2795Nfn4+K1asYN++fQwZMoTZs2eTnJzM0aNHOXLkiF2OWeRKKRCkyfv9k/5jjz3G559/zokTJ0hPT2fs2LF069aNRx55pNY6RqORnTt38tNPP3Ho0CEmTJhAUVER5eXlABw7dowZM2Zw8OBBfvrpJ7Zu3Ur79u1p27Ytubm5zJw5k71793LixAk2bdqEh4cHHTt2tPehi1wWnVSWJq9t27asW7eOd955h+nTp5Ofn4/RaCQkJISYmBhcXV1rrTN79mxeffVVwsLCaNu2LYMGDWLEiBEcOnQIuPgto9dee40nn3ySsrIyevbsydKlS3FycmLixImUlZUxadIkioqK6NKlC0uXLqVVq1b2PnSRy2LQHdNERAQ0ZCQiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERAa7xeyqfPVtCdbXuACoi0hBOTgbatLnhkvOv6UCorjYpEEREGomGjEREBFAgiIiImQJBREQABYKIiJgpEEREBFAgiIiImQJBRESAa/x3CHJ9aN3aHVdXZ0eX0aSVl1dRVPSro8sQB1MgyP88V1dnZrx9xNFlNGkvxfo6ugT5H6AhIxERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJiZtNASE1NZciQIQQFBbFmzZpa8w8dOkRERARDhw7lqaee4vz587YsR0RE6mGzQMjNzSUxMZG1a9eSkpLChg0bOHr0aI1lEhISiI2NZcuWLXTs2JHly5fbqhwREbHCZoGQmZlJQEAAnp6euLu7ExwcTFpaWo1lqqurKSkpAaC0tJTmzZvbqhwREbHCZoGQl5eHt7e3ZdrHx4fc3Nway0ydOpX4+Hj69u1LZmYmkZGRtipHRESsaGarDZtMplrPGQwGy+OysjLi4+NZuXIl/v7+vPfee0yZMoWkpKQG78PLy6NRahUR8PZu6egSxMFsFghGo5EvvvjCMp2Xl4ePj49lOjs7Gzc3N/z9/QF49NFHmT9//mXto6DgAtXVtYNHmha9UdnHmTPFji5BbMzJyVDvB2mbDRkFBgaSlZVFYWEhpaWlpKen069fP8v8W2+9ldOnT3Ps2DEAtm/fjp+fn63KERERK2zaQ5g0aRJRUVFUVFQwYsQI/P39iY6OJjY2Fj8/P2bNmsXEiRMxmUx4eXnx+uuv26ocERGxwmCqa7D/GqEho+uDt3dLZrx9xNFlNGkvxfpqyOg64LAhIxERubbYbMhIRASgpac7zV2cHV1Gk1ZWUUXxuV+vejsKBBGxqeYuzvxt3QlHl9Gkrf6/m2mMAT8NGYmICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICADNbLnx1NRUFi9eTEVFBY899hijR4+uMf/YsWO8/PLLFBUV4e3tzdy5c2ndunWj1+HZqgUubjY9VAEqfqvk3PlSR5chIlfIZu+Subm5JCYmsmnTJlxdXYmMjKRPnz507twZAJPJxNNPP018fDz9+vVjzpw5JCUlMXny5EavxcWtGSvjMht9u1LT398MdHQJInIVbDZklJmZSUBAAJ6enri7uxMcHExaWppl/qFDh3B3d6dfv34AxMTE1OpBiIiI/dish5CXl4e3t7dl2sfHhwMHDlimf/75Z9q1a8eUKVP49ttvueOOO5g+ffpl7cPLy6PR6pXG4e3d0tElyBVS213bGqP9rAbCqlWrGD58OB4el/fmazKZaj1nMBgsjysrK/nPf/7D6tWr8fPzY968ecyePZvZs2c3eB8FBReorq69nz/TH7r9nDlT3OjbVPvZhy3aDtR+9tKQ9nNyMtT7QdrqkFF2djbBwcHEx8dz8ODBBhdnNBrJz8+3TOfl5eHj42OZ9vb25tZbb8XPzw+A0NDQGj0IERGxL6uBMHPmTLZt20b37t159dVXiYiI4IMPPuC3336rd73AwECysrIoLCyktLSU9PR0y/kCgLvuuovCwkIOHz4MQEZGBt26dbvKwxERkSvVoJPKHh4ehISEEBoayrlz51i7di0hISE1ThL/mdFoZNKkSURFRTFs2DBCQ0Px9/cnOjqagwcP0rx5cxYtWsS0adN46KGH2LNnD1OnTm20AxMRkctj9RxCZmYmycnJZGVlERwczKJFi+jSpQs///wzo0aNIiQk5JLrhoWFERYWVuO5ZcuWWR736NGDDz744CrKFxGRxmI1EGbMmMGoUaOYOXMmLVv+cXLolltuYeTIkTYtTkRE7MfqkNGWLVvw9PSkZcuWnDlzhhUrVlBdXQ1AbGyszQsUERH7aNBJ5R07dlxc2MmJffv28frrr9u6LhERsTOrQ0ZffvklW7duBcDLy4v58+cTHh5u88JERMS+rPYQKioqKC8vt0xXVlbatCAREXEMqz2EAQMGMHbsWMLDwzEYDGzdupX+/fvbozYREbEjq4EQFxfHmjVr2L59O82aNSMoKIjIyEh71CYiInZkNRCcnZ2JiooiKirKHvWIiIiDWA2Ejz76iDlz5lBUVFTjgnX79++3aWEiImJfVgNh/vz5TJ06la5du9a4WqmIiDQtVgOhVatWDB482B61iIiIA1n92mmPHj3YuXOnPWoREREHstpD2LlzJ6tXr8bFxQUXFxdMJhMGg0HnEEREmhirgbBixQo7lCEiIo5mdcioffv2HDx4kOTkZNq2bcuXX35J+/bt7VGbiIjYkdVASEpKYt26daSlpVFWVsbChQtZtGiRPWoTERE7shoI//rXv1i2bBktWrSgTZs2JCcnWy52JyIiTYfVQGjWrBmurq6W6VatWtGsmdVTDyIico2x+s5+4403smPHDgwGA+Xl5SxfvlznEEREmiCrgTB9+nTi4uI4cuQIPXv2pEePHsyZM8cetYmIiB1ZDQSj0cjKlSspLS2lqqoKDw8Pe9QlIiJ2ZjUQ3nvvvTqff/zxxxu9GBERcRyrgZCdnW15XF5ezr59++jTp49NixIREfuzGgizZs2qMV1YWEhcXJzNChIREcew+rXTP2vbti2nTp2yRS0iIuJAl3UOwWQy8c033+Dl5WXTokRExP4u6xwCXPxdgoaMRESanss+hyAiIk2T1UAYM2ZMvbfOfP/99xu1IBERcQyrgdC9e3d++OEHRo4ciYuLCykpKVRWVvLQQw/Zoz4REbETq4Gwf/9+1q5di7OzMwD3338/I0eOJDg42ObFiYiI/Vj92mlhYSHl5eWW6ZKSEsrKymxalIiI2J/VHkJoaCgjR44kKCgIk8nExx9/TFRUlD1qExERO7IaCBMmTKBr167s3r0bNzc3ZsyYQe/eve1Rm4iI2FGDfqlsNBq5/fbbmThxIi4uLrauSUREHMBqIGzcuJEXXniBd999l+LiYsaPH09ycrI9ahMRETuyGgirV69mw4YNeHh44OXlxaZNm1i5cmWDNp6amsqQIUMICgpizZo1l1xux44dDBw4sOFVi4hIo7N6DsHJyanGTXFuvPFGy1dQ65Obm0tiYiKbNm3C1dWVyMhI+vTpQ+fOnWssl5+fzxtvvHEFpYuISGOy2kPw9PTku+++s/xaecuWLbRu3drqhjMzMwkICMDT0xN3d3eCg4NJS0urtdy0adN49tlnr6B0ERFpTFZ7CC+++CITJkzg559/pm/fvri5ufHOO+9Y3XBeXh7e3t6WaR8fHw4cOFBjmffff5+uXbvSo0ePKygdvLx0O8//Nd7eLR1dglwhtd21rTHaz2oglJWVkZKSwvHjx6mqqqJjx44N+qaRyWSq9dx/XxMpOzub9PR0VqxYwenTpy+z7IsKCi5QXV17P3+mP3T7OXOmuNG3qfazD1u0Haj97KUh7efkZKj3g7TVIaPnn38eZ2dnOnXqxB133NHgr50ajUby8/Mt03l5efj4+Fim09LSOHPmDBEREYwbN468vDxGjRrVoG2LiEjjsxoIvr6+pKamkpOTw7lz5yz/rAkMDCQrK4vCwkJKS0tJT0+nX79+lvmxsbFs27aNlJQUkpKS8PHxYe3atVd1MCIicuWsDhlt37691slgg8HAd999V+96RqORSZMmERUVRUVFBSNGjMDf35/o6GhiY2Px8/O7uspFRKRRWQ2EgwcPXvHGw8LCCAsLq/HcsmXLai3XoUMHMjIyrng/IiJy9S45ZDR9+nTL48LCQrsUIyIijnPJQPjmm28sj8eOHWuXYkRExHEuGQj//bXRur5CKiIiTUuDrnZa3z2VRUSkabjkSeXq6mqKioowmUxUVVVZHv/O09PTHvWJiIidXDIQsrOzCQgIsIRAnz59LPMa8rVTERG5tlwyEA4fPmzPOkRExMEadA5BRESaPgWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICKBAEBERMwWCiIgACgQRETFTIIiICGDjQEhNTWXIkCEEBQWxZs2aWvM/+eQTwsPDGTp0KOPHj6eoqMiW5YiISD1sFgi5ubkkJiaydu1aUlJS2LBhA0ePHrXMv3DhAq+88gpJSUls2bIFX19fFixYYKtyRETECpsFQmZmJgEBAXh6euLu7k5wcDBpaWmW+RUVFbzyyisYjUYAfH19+eWXX2xVjoiIWGGzQMjLy8Pb29sy7ePjQ25urmW6TZs2DBo0CICysjKSkpIs0yIiYn/NbLVhk8lU6zmDwVDrueLiYsaPH0+XLl0YPnz4Ze3Dy8vjiusT2/D2bunoEuQKqe2ubY3RfjYLBKPRyBdffGGZzsvLw8fHp8YyeXl5jB07loCAAF588cXL3kdBwQWqq2sHz5/pD91+zpwpbvRtqv3swxZtB2o/e2lI+zk5Ger9IG2zIaPAwECysrIoLCyktLSU9PR0+vXrZ5lfVVVFTEwMDz74IPHx8XX2HkRExH5s2kOYNGkSUVFRVFRUMGLECPz9/YmOjiY2NpbTp0/z7bffUlVVxbZt2wDo3r07CQkJtipJRETqYbNAAAgLCyMsLKzGc8uWLQPAz8+Pw4cP23L3IiJyGfRLZRERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImYKBBERARQIIiJipkAQERFAgSAiImY2DYTU1FSGDBlCUFAQa9asqTX/u+++IyIiguDgYOLj46msrLRlOSIiUg+bBUJubi6JiYmsXbuWlJQUNmzYwNGjR2ssM3nyZKZPn862bdsw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",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "success_rate_plot(p_attr, y)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We also observe that the white group has a much higher pass rate (within the dataset) than the non-white group."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## **Train a model**\n",
    "\n",
    "Here we train a Logistic Regression classifier."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "id": "fo4na9kCw6bN"
   },
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "# split features and target, then train test split\n",
    "n_cols = len(df.columns)\n",
    "X = df.iloc[:,:n_cols-1]\n",
    "y = df.iloc[:,n_cols-1]\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "# train a model, then predict on the test set\n",
    "LR = LogisticRegression(random_state=42, max_iter=500)\n",
    "LR.fit(X_train,y_train)\n",
    "y_pred = LR.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "accuracy  : 0.9073333333333333\n",
      "precision : 0.917215102182196\n",
      "recall    : 0.9854856717528843\n",
      "f1        : 0.9501255830642268\n"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score\n",
    "\n",
    "# evaluate\n",
    "print ('accuracy  : ' + str(accuracy_score(y_test, y_pred)))\n",
    "print ('precision : ' + str(precision_score(y_test, y_pred)))\n",
    "print ('recall    : ' + str(recall_score(y_test, y_pred)))\n",
    "print ('f1        : ' + str(f1_score(y_test, y_pred)))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## **Measure bias**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The holisticai.bias.metrics module contains a range of metrics useful in evaluating the fairness of algorithmic decisions. In this case we use only a few of the metrics relevant to a classification task."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "# import some bias metrics\n",
    "from holisticai.bias.metrics import statistical_parity\n",
    "from holisticai.bias.metrics import disparate_impact\n",
    "from holisticai.bias.metrics import accuracy_diff"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "# set up groups, prediction array and true (aka target/label) array.\n",
    "group_a = np.array(X_test[\"racetxt\"]==0) # non-white vector\n",
    "group_b = np.array(X_test[\"racetxt\"]==1) # white vector\n",
    "y_pred  = np.array(LR.predict(X_test))   # predicion vector\n",
    "y_true  = np.array(y_test)               # true vector"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-0.3285839719029374"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# compute statistical parity\n",
    "statistical_parity(group_a, group_b, y_pred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The statistical parity indicates the difference in success rate between non-white and white groups is -0.3. This is outside of ranges considered fair (-0.1, 0.1)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.6667476219388788"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# compute disparate impact\n",
    "disparate_impact(group_a, group_b, y_pred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The diparate impact metric indicates non-whites are about 0.66 times as likely than whites to pass the bar."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-0.18949553001277142"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# compute false positive rate difference\n",
    "accuracy_diff(group_a, group_b, y_pred, y_true)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The above metric is different from the first two in that it also uses the target values, this is an equality of opportunity metric. A value of -0.18 shows that the classifier we trained is less accurate on non-white group than white group. This is expected because of the data imbalance."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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oqKiGD16NCEhIfj5+RETE8OXX37ZKMWLiEjjueyQUbNmzRg5ciQjR44kNzeXVatWUVZWxogRI5g4cSIPPPCA3cZDQ0Nr3YJz6dKltZa78cYbyczM/Bnli4hIY7F72ilA9+7diY+P59NPPyU6OpqUlBSj6xIREQerVyD8oHXr1owbN47169cbVY+IiDSRBgWCiIhcvRQIIiICKBBERMRKgSAiIoACQURErBQIIiICKBBERMRKgSAiIoACQURErBQIIiICKBBERMRKgSAiIoACQURErBQIIiICKBBERMRKgSAiIoACQURErBQIIiICKBBERMRKgSAiIoACQURErBQIIiICKBBERMRKgSAiIoACQURErBQIIiICKBBERMRKgSAiIoACQURErBQIIiICKBBERMRKgSAiIoACQURErBQIIiICGBwI6enpBAcHM3z4cJKTk2vNz8jIIDw8nLCwMKZMmcLp06eNLEdEROpgWCDk5+eTkJDAypUrSU1NZfXq1eTm5trmnzt3jnnz5rFkyRLS0tLw9vYmKSnJqHJERMQOwwIhKyuLgIAA2rVrh4uLC0FBQWzevNk2v6Kignnz5uHh4QGAt7c3x44dM6ocERGxw7BAKCgowGw226bd3d3Jz8+3Tbdv355hw4YBUFZWxpIlS2zTIiLieM2MathisdR6zmQy1Xru7NmzTJkyhZ49ezJmzJgGrcPNzfVn1yfGMJuva+oS5GdS313ZGqP/DAsEDw8PvvjiC9t0QUEB7u7uNZYpKCggOjqagIAAnnvuuQavo6joHNXVtYPnp/RGd5wTJ842epvqP8cwou9A/eco9ek/JydTnV+kDRsyCgwMJDs7m+LiYkpLS9m6dSsDBw60za+qqmLy5MmMHDmSOXPmXHLvQUREHMfQPYQZM2YQFRVFRUUFERER+Pn5ERMTQ2xsLMePH+err76iqqqKLVu2AODj48P8+fONKklEROpgWCAAhIaGEhoaWuO5pUuXAuDr68u+ffuMXL2IiDSAfqksIiKAAkFERKwUCCIiAigQRETESoEgIiKAAkFERKwUCCIiAigQRETESoEgIiKAAkFERKwUCCIiAigQRETESoEgIiKAAkFERKwUCCIiAigQRETESoEgIiKAAkFERKwUCCIiAigQRETESoEgIiKAAkFERKwUCCIiAigQRETESoEgIiKAAkFERKwU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qaiooHfv3vzxj39sUBuDBw9m2bJl9OvXDxcXFyoqKhg8eHC9X+/n58cbb7zBn//8Z6ZPn853333HmDFjqKys5L777qszoOTSBg0axJ49e/Dy8sJsNlNUVMTgwYOpqKiw+9o77riDWbNm0bFjR6ZNm8a8efMICQmx7b3ddNNNDtgC+alFixYxb948kpKSaN68OUlJSbRo0aJGf02aNIm4uDjatm2Lm5sbPj4+fP/9901dumF0tVMREQE0ZCQiIlYKBBERARQIIiJipUAQERFAgSAiIlY67VSkDn/5y19ISUnh3LlzVFRU0LVrV5588kn69OnT1KWJNDoFgshlvPbaa+zZs4fExES6dOkCXLwUyKRJk1i3bh033HBDE1co0rj0OwSRSygsLOSee+7hr3/9K+7u7jXmbdiwAV9fX2JiYvDz8+Prr7/mqaeewtPTkxdeeIFTp05hMpl49NFHGT16NLt37+bFF1+0Xdn0x9NJSUkcOHCAwsJCioqK6NmzJ/Pnz8fV1bUpNluucdpDELmEf//733h5edUKA4DRo0fbHvfo0YPExEQqKyu59957iYuLY8SIEeTn53P//ffTrVs3u+v6z3/+w9q1a+nQoQMzZ87kzTffZNasWY25OSL1ooPKIpfw0x3nc+fO2e6yNXz4cF577TUAbr/9dgAOHTrEhQsXbBcR9PDwYMSIEXz66ad213XvvffSsWNHnJyciIiI4LPPPmvkrRGpH+0hiFyCn58f3377LSdPnqR9+/a4urra7rKVlJRku8T1D1eOvdQFz3640u1Pr4D60+sf/fiihdXV1Tg56XuaNA2980QuwcPDg6ioKKZPn05eXp7t+by8PP75z3/W+tC++eabad68ue3qmfn5+WzZsoXAwEA6dOhAXl4eRUVFWCwWMjIyarx227ZtnD17lurqalJSUmz3vRBxNO0hiFzGjBkzSEtL45lnnuH8+fNUVlbSokULgoODmTBhApmZmbZlmzdvzltvvcWf/vQnkpKSqKqqYurUqQQEBADY7sBlNptrXbm2Y8eOxMTEcPLkSe644w4mT57syM0UsdFZRiJN6Ifhp+eff76pSxHRkJGIiFykPQQREQG0hyAiIlYKBBERARQIIiJipUAQERFAgSAiIlYKBBERAeD/AYclNibYTKKkAAAAAElFTkSuQmCC",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "from holisticai.bias.plots import accuracy_bar_plot\n",
    "p_attr = X_test[\"racetxt\"].replace({1:'white',0:'non-white'})\n",
    "accuracy_bar_plot(p_attr, y_pred, y_true)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The above shows the same result as accuracy_diff metric in plot form."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Equality of outcome metrics (batch computation)**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We also allow for the computation of all metrics in a 'batch' form. Here we can specify the type of metric within the metric_type attribute."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "# import function for batch computation\n",
    "from holisticai.bias.metrics import classification_bias_metrics"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Value</th>\n",
       "      <th>Reference</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Metric</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Statistical Parity</th>\n",
       "      <td>-0.328584</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Disparate Impact</th>\n",
       "      <td>0.666748</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Four Fifths Rule</th>\n",
       "      <td>0.666748</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Cohen D</th>\n",
       "      <td>-1.930391</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                       Value  Reference\n",
       "Metric                                 \n",
       "Statistical Parity -0.328584          0\n",
       "Disparate Impact    0.666748          1\n",
       "Four Fifths Rule    0.666748          1\n",
       "Cohen D            -1.930391          0"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classification_bias_metrics(group_a, group_b, y_pred, y_true, metric_type='equal_outcome')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Equality of opportunity metrics (batch computation)**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Value</th>\n",
       "      <th>Reference</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Metric</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Equality of Opportunity Difference</th>\n",
       "      <td>-0.181083</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>False Positive Rate Difference</th>\n",
       "      <td>-0.489336</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Average Odds Difference</th>\n",
       "      <td>-0.335210</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Accuracy Difference</th>\n",
       "      <td>-0.189496</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Correlation Difference</th>\n",
       "      <td>0.179134</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                       Value  Reference\n",
       "Metric                                                 \n",
       "Equality of Opportunity Difference -0.181083          0\n",
       "False Positive Rate Difference     -0.489336          0\n",
       "Average Odds Difference            -0.335210          0\n",
       "Accuracy Difference                -0.189496          0\n",
       "Correlation Difference              0.179134          0"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "classification_bias_metrics(group_a, group_b, y_pred, y_true, metric_type='equal_opportunity')"
   ]
  }
 ],
 "metadata": {
  "colab": {
   "collapsed_sections": [
    "f6hoB7SDMGnm",
    "GV7HUVoiKE0T",
    "yq0-K1xSKaNy"
   ],
   "name": "Measuring Bias ",
   "provenance": []
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.4"
  },
  "vscode": {
   "interpreter": {
    "hash": "f5fa74478a026ac530ef194e4df855dfb9675779484e20284ae5f690a2266d7b"
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
